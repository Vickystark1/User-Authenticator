{"version":3,"names":["createElement","h","Component","PropTypes","DashboardPlugin","cssSize","locale","metaFields","plugins","uppy","uppyPropType","getHTMLProps","nonHtmlPropsHaveChanged","DashboardModal","componentDidMount","installPlugin","componentDidUpdate","prevProps","open","onRequestClose","props","uninstallPlugin","options","inline","onRequestCloseModal","plugin","setOptions","closeModal","openModal","componentWillUnmount","target","container","rest","id","use","getPlugin","removePlugin","render","className","ref","propTypes","isRequired","window","instanceOf","HTMLElement","any","bool","func","closeModalOnClickOutside","disablePageScrollWhenModalOpen","width","height","showProgressDetails","note","string","proudlyDisplayPoweredByUppy","autoOpenFileEditor","animateOpenClose","browserBackButtonClose","closeAfterFinish","disableStatusBar","disableInformer","disableThumbnailGenerator","disableLocalFiles","disabled","hideCancelButton","hidePauseResumeButton","hideProgressAfterFinish","hideRetryButton","hideUploadButton","showLinkToFileUploadResult","showRemoveButtonAfterComplete","showSelectedFiles","waitForThumbnailsBeforeUpload","fileManagerSelectionType","theme","thumbnailType","thumbnailWidth","number","defaultProps","undefined"],"sources":["DashboardModal.ts"],"sourcesContent":["import { createElement as h, Component } from 'react'\nimport PropTypes from 'prop-types'\nimport DashboardPlugin, { type DashboardOptions } from '@uppy/dashboard'\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport type { Uppy } from '@uppy/core'\nimport {\n  cssSize,\n  locale,\n  metaFields,\n  plugins,\n  uppy as uppyPropType,\n} from './propTypes.ts'\nimport getHTMLProps from './getHTMLProps.ts'\nimport nonHtmlPropsHaveChanged from './nonHtmlPropsHaveChanged.ts'\n\ntype DashboardInlineOptions<M extends Meta, B extends Body> = Omit<\n  DashboardOptions<M, B> & { inline: false },\n  'inline' | 'onRequestCloseModal'\n> &\n  React.BaseHTMLAttributes<HTMLDivElement>\n\nexport interface DashboardModalProps<M extends Meta, B extends Body>\n  extends DashboardInlineOptions<M, B> {\n  uppy: Uppy<M, B>\n  onRequestClose: () => void\n  open: boolean\n}\n\n/**\n * React Component that renders a Dashboard for an Uppy instance in a Modal\n * dialog. Visibility of the Modal is toggled using the `open` prop.\n */\n\nclass DashboardModal<M extends Meta, B extends Body> extends Component<\n  DashboardModalProps<M, B>\n> {\n  static propTypes = {\n    uppy: uppyPropType.isRequired,\n    target:\n      typeof window !== 'undefined' ?\n        PropTypes.instanceOf(window.HTMLElement)\n      : PropTypes.any,\n    open: PropTypes.bool,\n    onRequestClose: PropTypes.func,\n    closeModalOnClickOutside: PropTypes.bool,\n    disablePageScrollWhenModalOpen: PropTypes.bool,\n    plugins,\n    width: cssSize,\n    height: cssSize,\n    showProgressDetails: PropTypes.bool,\n    note: PropTypes.string,\n    metaFields,\n    proudlyDisplayPoweredByUppy: PropTypes.bool,\n    autoOpenFileEditor: PropTypes.bool,\n    animateOpenClose: PropTypes.bool,\n    browserBackButtonClose: PropTypes.bool,\n    closeAfterFinish: PropTypes.bool,\n    disableStatusBar: PropTypes.bool,\n    disableInformer: PropTypes.bool,\n    disableThumbnailGenerator: PropTypes.bool,\n    disableLocalFiles: PropTypes.bool,\n    disabled: PropTypes.bool,\n    hideCancelButton: PropTypes.bool,\n    hidePauseResumeButton: PropTypes.bool,\n    hideProgressAfterFinish: PropTypes.bool,\n    hideRetryButton: PropTypes.bool,\n    hideUploadButton: PropTypes.bool,\n    showLinkToFileUploadResult: PropTypes.bool,\n    showRemoveButtonAfterComplete: PropTypes.bool,\n    showSelectedFiles: PropTypes.bool,\n    waitForThumbnailsBeforeUpload: PropTypes.bool,\n    fileManagerSelectionType: PropTypes.string,\n    theme: PropTypes.string,\n    // pass-through to ThumbnailGenerator\n    thumbnailType: PropTypes.string,\n    thumbnailWidth: PropTypes.number,\n    locale,\n  }\n\n  // Must be kept in sync with @uppy/dashboard/src/Dashboard.jsx.\n  static defaultProps = {\n    metaFields: [],\n    plugins: [],\n    width: 750,\n    height: 550,\n    thumbnailWidth: 280,\n    thumbnailType: 'image/jpeg',\n    waitForThumbnailsBeforeUpload: false,\n    showLinkToFileUploadResult: false,\n    showProgressDetails: false,\n    hideUploadButton: false,\n    hideCancelButton: false,\n    hideRetryButton: false,\n    hidePauseResumeButton: false,\n    hideProgressAfterFinish: false,\n    note: null,\n    closeModalOnClickOutside: false,\n    closeAfterFinish: false,\n    disableStatusBar: false,\n    disableInformer: false,\n    disableThumbnailGenerator: false,\n    disablePageScrollWhenModalOpen: true,\n    animateOpenClose: true,\n    fileManagerSelectionType: 'files',\n    proudlyDisplayPoweredByUppy: true,\n    showSelectedFiles: true,\n    showRemoveButtonAfterComplete: false,\n    browserBackButtonClose: false,\n    theme: 'light',\n    autoOpenFileEditor: false,\n    disabled: false,\n    disableLocalFiles: false,\n\n    // extra\n    open: undefined,\n    target: undefined,\n    locale: null,\n    onRequestClose: undefined,\n  }\n\n  private container: HTMLElement\n\n  private plugin: DashboardPlugin<M, B>\n\n  componentDidMount(): void {\n    this.installPlugin()\n  }\n\n  componentDidUpdate(prevProps: DashboardModal<M, B>['props']): void {\n    const { uppy, open, onRequestClose } = this.props\n    if (prevProps.uppy !== uppy) {\n      this.uninstallPlugin(prevProps)\n      this.installPlugin()\n    } else if (nonHtmlPropsHaveChanged(this.props, prevProps)) {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars,no-shadow\n      const { uppy, ...options } = {\n        ...this.props,\n        inline: false,\n        onRequestCloseModal: onRequestClose,\n      }\n      this.plugin.setOptions(options)\n    }\n    if (prevProps.open && !open) {\n      this.plugin.closeModal()\n    } else if (!prevProps.open && open) {\n      this.plugin.openModal()\n    }\n  }\n\n  componentWillUnmount(): void {\n    this.uninstallPlugin()\n  }\n\n  installPlugin(): void {\n    const {\n      target = this.container,\n      open,\n      onRequestClose,\n      uppy,\n      ...rest\n    } = this.props\n    const options = {\n      ...rest,\n      id: 'react:DashboardModal',\n      inline: false,\n      target,\n      open,\n      onRequestCloseModal: onRequestClose,\n    }\n\n    uppy.use(DashboardPlugin<M, B>, options)\n\n    this.plugin = uppy.getPlugin(options.id) as DashboardPlugin<M, B>\n    if (open) {\n      this.plugin.openModal()\n    }\n  }\n\n  uninstallPlugin(props = this.props): void {\n    const { uppy } = props\n\n    uppy.removePlugin(this.plugin)\n  }\n\n  render(): JSX.Element {\n    return h('div', {\n      className: 'uppy-Container',\n      ref: (container: HTMLElement) => {\n        this.container = container\n      },\n      ...getHTMLProps(this.props),\n    })\n  }\n}\n\nexport default DashboardModal\n"],"mappings":"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"}