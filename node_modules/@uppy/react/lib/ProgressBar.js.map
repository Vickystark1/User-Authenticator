{"version":3,"names":["createElement","h","Component","PropTypes","ProgressBarPlugin","uppy","uppyPropType","getHTMLProps","nonHtmlPropsHaveChanged","ProgressBar","componentDidMount","installPlugin","componentDidUpdate","prevProps","props","uninstallPlugin","options","target","container","plugin","setOptions","componentWillUnmount","fixed","hideAfterFinish","id","use","getPlugin","removePlugin","render","className","ref","propTypes","isRequired","bool","defaultProps"],"sources":["ProgressBar.ts"],"sourcesContent":["import { createElement as h, Component } from 'react'\nimport PropTypes from 'prop-types'\nimport type { UnknownPlugin, Uppy } from '@uppy/core'\nimport ProgressBarPlugin from '@uppy/progress-bar'\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport { uppy as uppyPropType } from './propTypes.ts'\nimport getHTMLProps from './getHTMLProps.ts'\nimport nonHtmlPropsHaveChanged from './nonHtmlPropsHaveChanged.ts'\n\ninterface ProgressBarProps<M extends Meta, B extends Body> {\n  uppy: Uppy<M, B>\n  fixed?: boolean\n  hideAfterFinish?: boolean\n}\n\n/**\n * React component that renders a progress bar at the top of the page.\n */\n\nclass ProgressBar<M extends Meta, B extends Body> extends Component<\n  ProgressBarProps<M, B>\n> {\n  static propTypes = {\n    uppy: uppyPropType.isRequired,\n    fixed: PropTypes.bool,\n    hideAfterFinish: PropTypes.bool,\n  }\n\n  // Must be kept in sync with @uppy/progress-bar/src/ProgressBar.jsx\n  static defaultProps = {\n    fixed: false,\n    hideAfterFinish: true,\n  }\n\n  private container: HTMLElement\n\n  private plugin: UnknownPlugin<M, B>\n\n  componentDidMount(): void {\n    this.installPlugin()\n  }\n\n  componentDidUpdate(prevProps: ProgressBar<M, B>['props']): void {\n    // eslint-disable-next-line react/destructuring-assignment\n    if (prevProps.uppy !== this.props.uppy) {\n      this.uninstallPlugin(prevProps)\n      this.installPlugin()\n    } else if (nonHtmlPropsHaveChanged(this.props, prevProps)) {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const { uppy, ...options } = { ...this.props, target: this.container }\n      this.plugin.setOptions(options)\n    }\n  }\n\n  componentWillUnmount(): void {\n    this.uninstallPlugin()\n  }\n\n  installPlugin(): void {\n    const { uppy, fixed, hideAfterFinish } = this.props\n    const options = {\n      id: 'react:ProgressBar',\n      fixed,\n      hideAfterFinish,\n      target: this.container,\n    }\n\n    uppy.use(ProgressBarPlugin, options)\n\n    this.plugin = uppy.getPlugin(options.id)!\n  }\n\n  uninstallPlugin(props = this.props): void {\n    const { uppy } = props\n\n    uppy.removePlugin(this.plugin)\n  }\n\n  render(): JSX.Element {\n    return h('div', {\n      className: 'uppy-Container',\n      ref: (container: HTMLElement) => {\n        this.container = container\n      },\n      ...getHTMLProps(this.props),\n    })\n  }\n}\n\nexport default ProgressBar\n"],"mappings":"AAAA,SAASA,aAAa,IAAIC,CAAC,EAAEC,SAAS,QAAQ,OAAO;AACrD,OAAOC,SAAS,MAAM,YAAY;AAElC,OAAOC,iBAAiB,MAAM,oBAAoB;AAElD,SAASC,IAAI,IAAIC,YAAY,QAAQ,gBAAgB;AACrD,OAAOC,YAAY,MAAM,mBAAmB;AAC5C,OAAOC,uBAAuB,MAAM,8BAA8B;AAQlE;AACA;AACA;;AAEA,MAAMC,WAAW,SAAyCP,SAAS,CAEjE;EAiBAQ,iBAAiBA,CAAA,EAAS;IACxB,IAAI,CAACC,aAAa,CAAC,CAAC;EACtB;EAEAC,kBAAkBA,CAACC,SAAqC,EAAQ;IAC9D;IACA,IAAIA,SAAS,CAACR,IAAI,KAAK,IAAI,CAACS,KAAK,CAACT,IAAI,EAAE;MACtC,IAAI,CAACU,eAAe,CAACF,SAAS,CAAC;MAC/B,IAAI,CAACF,aAAa,CAAC,CAAC;IACtB,CAAC,MAAM,IAAIH,uBAAuB,CAAC,IAAI,CAACM,KAAK,EAAED,SAAS,CAAC,EAAE;MACzD;MACA,MAAM;QAAER,IAAI;QAAE,GAAGW;MAAQ,CAAC,GAAG;QAAE,GAAG,IAAI,CAACF,KAAK;QAAEG,MAAM,EAAE,IAAI,CAACC;MAAU,CAAC;MACtE,IAAI,CAACC,MAAM,CAACC,UAAU,CAACJ,OAAO,CAAC;IACjC;EACF;EAEAK,oBAAoBA,CAAA,EAAS;IAC3B,IAAI,CAACN,eAAe,CAAC,CAAC;EACxB;EAEAJ,aAAaA,CAAA,EAAS;IACpB,MAAM;MAAEN,IAAI;MAAEiB,KAAK;MAAEC;IAAgB,CAAC,GAAG,IAAI,CAACT,KAAK;IACnD,MAAME,OAAO,GAAG;MACdQ,EAAE,EAAE,mBAAmB;MACvBF,KAAK;MACLC,eAAe;MACfN,MAAM,EAAE,IAAI,CAACC;IACf,CAAC;IAEDb,IAAI,CAACoB,GAAG,CAACrB,iBAAiB,EAAEY,OAAO,CAAC;IAEpC,IAAI,CAACG,MAAM,GAAGd,IAAI,CAACqB,SAAS,CAACV,OAAO,CAACQ,EAAE,CAAE;EAC3C;EAEAT,eAAeA,CAACD,KAAK,EAAqB;IAAA,IAA1BA,KAAK;MAALA,KAAK,GAAG,IAAI,CAACA,KAAK;IAAA;IAChC,MAAM;MAAET;IAAK,CAAC,GAAGS,KAAK;IAEtBT,IAAI,CAACsB,YAAY,CAAC,IAAI,CAACR,MAAM,CAAC;EAChC;EAEAS,MAAMA,CAAA,EAAgB;IACpB,OAAO3B,CAAC,CAAC,KAAK,EAAE;MACd4B,SAAS,EAAE,gBAAgB;MAC3BC,GAAG,EAAGZ,SAAsB,IAAK;QAC/B,IAAI,CAACA,SAAS,GAAGA,SAAS;MAC5B,CAAC;MACD,GAAGX,YAAY,CAAC,IAAI,CAACO,KAAK;IAC5B,CAAC,CAAC;EACJ;AACF;AApEML,WAAW,CAGRsB,SAAS,GAAG;EACjB1B,IAAI,EAAEC,YAAY,CAAC0B,UAAU;EAC7BV,KAAK,EAAEnB,SAAS,CAAC8B,IAAI;EACrBV,eAAe,EAAEpB,SAAS,CAAC8B;AAC7B,CAAC;AAED;AATIxB,WAAW,CAURyB,YAAY,GAAG;EACpBZ,KAAK,EAAE,KAAK;EACZC,eAAe,EAAE;AACnB,CAAC;AAyDH,eAAed,WAAW"}